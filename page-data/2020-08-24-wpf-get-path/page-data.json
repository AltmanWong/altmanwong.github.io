{"componentChunkName":"component---src-templates-blog-post-js","path":"/2020-08-24-wpf-get-path/","result":{"data":{"site":{"siteMetadata":{"title":"LAP-TECH"}},"markdownRemark":{"id":"96785a96-f8af-542b-9580-8d30556f8b12","excerpt":"有時為左簡化 Binding Process, 有需要放條 Binding Path 係 ViewModel 入面。執 Binding Path 嘅 Process 極為複雜，要對著個 Object 打番條 Path 出黎出錯機會極高。過一排要更改更加係一個地獄。 有冇唔洗咁傻仔既方法，唔洗下下都要對著個 Object…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/77415045782bbb9a74c380379ed6b591/28be2/cover.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.70270270270271%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeVlAg//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAAAARARITH/2gAIAQEAAT8hvCjB8U//2gAMAwEAAgADAAAAEGPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAQEAAwEAAAAAAAAAAAAAAREAIVFhgf/aAAgBAQABPxCG2Vz4nx07O4AKUzrv/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Binding\"\n        title=\"Binding\"\n        src=\"/static/77415045782bbb9a74c380379ed6b591/1c72d/cover.jpg\"\n        srcset=\"/static/77415045782bbb9a74c380379ed6b591/a80bd/cover.jpg 148w,\n/static/77415045782bbb9a74c380379ed6b591/1c91a/cover.jpg 295w,\n/static/77415045782bbb9a74c380379ed6b591/1c72d/cover.jpg 590w,\n/static/77415045782bbb9a74c380379ed6b591/28be2/cover.jpg 786w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>有時為左簡化 Binding Process, 有需要放條 Binding Path 係 ViewModel 入面。執 Binding Path 嘅 Process 極為複雜，要對著個 Object 打番條 Path 出黎出錯機會極高。過一排要更改更加係一個地獄。</p>\n<p>有冇唔洗咁傻仔既方法，唔洗下下都要對著個 Object Path 打番晒出黎，仲可以係有錯既時候提你呢？</p>\n<p>最好嘅方法就係直接 Create 個 <code class=\"language-text\">Object</code> 然後用 <code class=\"language-text\">dot</code> <code class=\"language-text\">dot</code> <code class=\"language-text\">dot</code> 跳入去你目標既 <code class=\"language-text\">Variable</code></p>\n<p>(1) 執 Path 好幫手 GetPath(Expression&#x3C;Func<object>> action)</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">string</span></span> <span class=\"token function\">GetPath</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Expression<span class=\"token punctuation\">&lt;</span>Func<span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> action<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> path <span class=\"token operator\">=</span> action<span class=\"token punctuation\">.</span>Body<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> originalObj <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">Split</span><span class=\"token punctuation\">(</span><span class=\"token string character\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">StartsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Convert\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Remove \")\" at the end of the expression</span>\n    path <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">Remove</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span>Length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">Remove</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> originalObj<span class=\"token punctuation\">.</span>Length <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>(2) Call GetPath</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token function\">GetPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Reactangle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Width<span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">)</span></code></pre></div>\n<p>上面既 Fuction (1) 用上 <code class=\"language-text\">LINQ Expression</code>，Create 一個 <code class=\"language-text\">Expression</code> 指去你要既 <code class=\"language-text\">Variable</code>。當 Pass 個 <code class=\"language-text\">Expression</code> 入去 <code class=\"language-text\">GetPath</code> 嘅時候 , <code class=\"language-text\">action.Body.ToString()</code> 就會識得 <code class=\"language-text\">return</code> 到 <code class=\"language-text\">new Rectangle().Width.Value</code>，咁就唔洗下下都自己打條 <code class=\"language-text\">String Path</code> 出黎！當個 <code class=\"language-text\">Object</code> 有更改既時候 IDE 自身都會提你條 <code class=\"language-text\">Path</code> 需要 <code class=\"language-text\">Update</code> 喇。</p>\n<p>而最正既係呢條 LINQ Expression 根本唔會 execute，只會佔用 Memory，因此唔會增加你既 execution time。但係 Memory 方面依然會受到影響。</p>","frontmatter":{"title":"C# 尋路人","date":"August 24, 2020"}}},"pageContext":{"slug":"/2020-08-24-wpf-get-path/","previous":{"fields":{"slug":"/2020-08-06-wpf-radiobutton-binding/"},"frontmatter":{"title":"WPF RadioButton Binding 方法"}},"next":{"fields":{"slug":"/2020-10-22-c-sharp-element-at/"},"frontmatter":{"title":"WPF ElementAt 慢過龜"}}}}}