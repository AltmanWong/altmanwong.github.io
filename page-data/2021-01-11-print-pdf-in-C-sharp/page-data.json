{"componentChunkName":"component---src-templates-blog-post-js","path":"/2021-01-11-print-pdf-in-C-sharp/","result":{"data":{"site":{"siteMetadata":{"title":"LAP-TECH"}},"markdownRemark":{"id":"1d941dfe-add9-50b4-aafe-a766913d87a6","excerpt":"近來工作需要要用到 Print PDF 嘅 function，所以就上網周圍搵點 print PDF 最直接嘅方法係 Call Command，前題係 User 要有裝到 Adobe PDF Reader 唔係就要 Send 個 Print command 出去等 System 自己 Call default…","html":"<p>近來工作需要要用到 Print PDF 嘅 function，所以就上網周圍搵點 print PDF</p>\n<p>最直接嘅方法係 Call Command，前題係 User 要有裝到 Adobe PDF Reader</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">AcroRd32。exe \\p &lt;filename&gt;</code></pre></div>\n<p>唔係就要 Send 個 Print command 出去等 System 自己 Call default 嘅 Print process</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">PrintPDF</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token class-name\">Process</span> printProcess <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Process</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n      StartInfo <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ProcessStartInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">{</span>\n          FileName <span class=\"token operator\">=</span> filePath<span class=\"token punctuation\">,</span>\n          Verb <span class=\"token operator\">=</span> <span class=\"token string\">\"Print\"</span><span class=\"token punctuation\">,</span>\n          UseShellExecute <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n          CreateNoWindow <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n          WindowStyle <span class=\"token operator\">=</span> ProcessWindowStyle。Hidden\n      <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  printProcess。<span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>但係唔知點解個 Print Command 成日都唔 Work (我用緊 Adobe PDF Reader DC)</p>\n<p>本來都唔想搵 3rd Party Library，但個Reader成日唔Work最後都係要靠人地</p>\n<p>而我用嘅Library就係 <code class=\"language-text\">PDFium。Viewer</code>，係 <code class=\"language-text\">NuGet</code> 打就搵到架喇！</p>\n<p>段 Code 大約係咁嘅:</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Print</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> filePath<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  System。Windows。Forms。<span class=\"token class-name\">PrintDialog</span> printDialog <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> System。Windows。Forms。<span class=\"token function\">PrintDialog</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">using</span> <span class=\"token punctuation\">(</span>PdfiumViewer。<span class=\"token class-name\">PdfDocument</span> document <span class=\"token operator\">=</span> PdfDocument。<span class=\"token function\">Load</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n    printDialog。AllowPrintToFile <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    printDialog。AllowSomePages <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    printDialog。PrinterSettings。MinimumPage <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    printDialog。PrinterSettings。MaximumPage <span class=\"token operator\">=</span> document。PageCount<span class=\"token punctuation\">;</span>\n    printDialog。PrinterSettings。FromPage <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    printDialog。PrinterSettings。ToPage <span class=\"token operator\">=</span> document。PageCount<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>printDialog。<span class=\"token function\">ShowDialog</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> System。Windows。Forms。DialogResult。OK<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">try</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">PageSettings</span> pageSettings <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">PageSettings</span><span class=\"token punctuation\">(</span>printDialog。PrinterSettings<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n          Margins <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Margins</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n          PaperSize <span class=\"token operator\">=</span> printDialog。PrinterSettings。DefaultPageSettings。PaperSize\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">using</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> printDocument <span class=\"token operator\">=</span> document。<span class=\"token function\">CreatePrintDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n          printDocument。PrinterSettings <span class=\"token operator\">=</span> printDialog。PrinterSettings<span class=\"token punctuation\">;</span>\n          printDocument。DefaultPageSettings <span class=\"token operator\">=</span> pageSettings<span class=\"token punctuation\">;</span>\n          printDocument。PrintController <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">StandardPrintController</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          printDocument。<span class=\"token function\">Print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> ex<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">{</span>\n        System。Diagnostics。Debug。<span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span>ex。<span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>首先就彈一個 <code class=\"language-text\">PrintDialog</code> 出來比 User 揀佢想用嘅 Printer，頁數同埋份數，之後就會射番比 <code class=\"language-text\">PdfiumViewer</code> 個邊 Create 個 <code class=\"language-text\">PdfDocument</code>。 最後就經番 <code class=\"language-text\">PdfiumViewer</code> 根據 <code class=\"language-text\">PrintDialog。PrinterSettings</code> 去 Print 番份 PDF 出黎。 就係咁簡單！</p>","frontmatter":{"title":"Print PDF in C#","date":"January 11, 2021"}}},"pageContext":{"slug":"/2021-01-11-print-pdf-in-C-sharp/","previous":{"fields":{"slug":"/2020-11-27-postgres-redis-docker/"},"frontmatter":{"title":"Postgres x Redis x Docker 起機懶人包"}},"next":{"fields":{"slug":"/2021-03-16-wpf-datagrid-header-binding/"},"frontmatter":{"title":"WPF DataGrid Header Binding"}}}}}